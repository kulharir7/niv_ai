{
  "actions": [],
  "creation": "2026-02-09 00:00:00",
  "doctype": "DocType",
  "engine": "InnoDB",
  "field_order": [
    "ai_section",
    "default_provider",
    "default_model",
    "system_prompt",
    "max_tokens_per_message",
    "max_messages_per_conversation",
    "column_break_ai",
    "enable_tools",
    "enable_billing",
    "enable_widget",
    "enable_knowledge_base",
    "widget_section",
    "widget_position",
    "widget_title",
    "widget_color",
    "column_break_widget",
    "allowed_roles",
    "billing_section",
    "billing_mode",
    "shared_pool_balance",
    "shared_pool_used",
    "per_user_daily_limit",
    "admin_allocation_only",
    "token_cost_input",
    "token_cost_output",
    "column_break_billing",
    "razorpay_enabled",
    "payment_gateway_section",
    "razorpay_key_id",
    "razorpay_key_secret",
    "column_break_payment",
    "payment_currency",
    "razorpay_webhook_secret",
    "currency",
    "voice_section",
    "enable_voice",
    "stt_engine",
    "tts_engine",
    "column_break_voice",
    "tts_voice",
    "tts_language",
    "auto_play_response",
    "voice_api_section",
    "voice_api_key",
    "voice_base_url",
    "column_break_voice_api",
    "default_voice",
    "tts_model",
    "image_section",
    "enable_image_generation",
    "image_api_key",
    "column_break_image",
    "image_api_url"
  ],
  "fields": [
    {"fieldname": "ai_section", "fieldtype": "Section Break", "label": "AI Configuration"},
    {"fieldname": "default_provider", "fieldtype": "Link", "label": "Default Provider", "options": "Niv AI Provider"},
    {"fieldname": "default_model", "fieldtype": "Data", "label": "Default Model"},
    {"fieldname": "system_prompt", "fieldtype": "Text", "label": "Default System Prompt", "default": "You are Niv AI, a helpful assistant integrated with ERPNext. You can help users with their business data, create documents, generate reports, and answer questions. Be concise and helpful."},
    {"fieldname": "max_tokens_per_message", "fieldtype": "Int", "label": "Max Tokens Per Message", "default": "4096"},
    {"fieldname": "max_messages_per_conversation", "fieldtype": "Int", "label": "Max Messages in Context", "default": "50"},
    {"fieldname": "column_break_ai", "fieldtype": "Column Break"},
    {"fieldname": "enable_tools", "fieldtype": "Check", "label": "Enable Tools", "default": "1"},
    {"fieldname": "enable_billing", "fieldtype": "Check", "label": "Enable Billing", "default": "0"},
    {"fieldname": "enable_widget", "fieldtype": "Check", "label": "Enable Floating Widget", "default": "1"},
    {"fieldname": "enable_knowledge_base", "fieldtype": "Check", "label": "Enable Knowledge Base (RAG)", "default": "0"},
    {"fieldname": "widget_section", "fieldtype": "Section Break", "label": "Widget Settings"},
    {"fieldname": "widget_position", "fieldtype": "Select", "label": "Widget Position", "options": "bottom-right\nbottom-left", "default": "bottom-right"},
    {"fieldname": "widget_title", "fieldtype": "Data", "label": "Widget Title", "default": "Niv AI"},
    {"fieldname": "widget_color", "fieldtype": "Color", "label": "Widget Color", "default": "#7C3AED"},
    {"fieldname": "column_break_widget", "fieldtype": "Column Break"},
    {"fieldname": "allowed_roles", "fieldtype": "Table", "label": "Allowed Roles", "options": "Has Role"},
    {"fieldname": "billing_section", "fieldtype": "Section Break", "label": "Billing Settings"},
    {"fieldname": "billing_mode", "fieldtype": "Select", "label": "Billing Mode", "options": "Per User\nShared Pool", "default": "Shared Pool", "depends_on": "enable_billing", "description": "Per User: each user has own wallet. Shared Pool: one company pool, all users consume from it."},
    {"fieldname": "shared_pool_balance", "fieldtype": "Int", "label": "Shared Pool Balance", "default": "0", "depends_on": "eval:doc.enable_billing && doc.billing_mode=='Shared Pool'", "description": "Total tokens available in shared pool"},
    {"fieldname": "shared_pool_used", "fieldtype": "Int", "label": "Shared Pool Used", "default": "0", "read_only": 1, "depends_on": "eval:doc.enable_billing && doc.billing_mode=='Shared Pool'"},
    {"fieldname": "per_user_daily_limit", "fieldtype": "Int", "label": "Per User Daily Limit", "default": "0", "depends_on": "eval:doc.enable_billing && doc.billing_mode=='Shared Pool'", "description": "Max tokens per user per day (0 = unlimited)"},
    {"fieldname": "admin_allocation_only", "fieldtype": "Check", "label": "Admin Allocation Only", "default": "1", "depends_on": "eval:doc.enable_billing && doc.billing_mode=='Per User'"},
    {"fieldname": "token_cost_input", "fieldtype": "Float", "label": "Cost per 1K Input Tokens", "default": "1"},
    {"fieldname": "token_cost_output", "fieldtype": "Float", "label": "Cost per 1K Output Tokens", "default": "3"},
    {"fieldname": "column_break_billing", "fieldtype": "Column Break"},
    {"fieldname": "razorpay_enabled", "fieldtype": "Check", "label": "Enable Razorpay Payments", "default": "0"},
    {"fieldname": "payment_gateway_section", "fieldtype": "Section Break", "label": "Payment Gateway", "description": "Configure Razorpay keys for real payments. Leave empty for demo mode (fake payments for testing)."},
    {"fieldname": "razorpay_key_id", "fieldtype": "Data", "label": "Razorpay Key ID", "description": "Leave empty for demo mode"},
    {"fieldname": "razorpay_key_secret", "fieldtype": "Password", "label": "Razorpay Key Secret", "description": "Leave empty for demo mode"},
    {"fieldname": "column_break_payment", "fieldtype": "Column Break"},
    {"fieldname": "payment_currency", "fieldtype": "Data", "label": "Payment Currency", "default": "INR"},
    {"fieldname": "razorpay_webhook_secret", "fieldtype": "Password", "label": "Razorpay Webhook Secret"},
    {"fieldname": "currency", "fieldtype": "Data", "label": "Currency (Legacy)", "default": "INR", "hidden": 1},
    {"fieldname": "voice_section", "fieldtype": "Section Break", "label": "Voice Settings"},
    {"fieldname": "enable_voice", "fieldtype": "Check", "label": "Enable Voice Features", "default": "1"},
    {"fieldname": "stt_engine", "fieldtype": "Select", "label": "STT Engine", "options": "browser\nwhisper", "default": "browser"},
    {"fieldname": "tts_engine", "fieldtype": "Select", "label": "TTS Engine", "options": "browser\nopenai\nelevenlabs", "default": "browser"},
    {"fieldname": "column_break_voice", "fieldtype": "Column Break"},
    {"fieldname": "tts_voice", "fieldtype": "Data", "label": "TTS Voice"},
    {"fieldname": "tts_language", "fieldtype": "Select", "label": "TTS Language", "options": "en\nhi\nauto", "default": "en"},
    {"fieldname": "auto_play_response", "fieldtype": "Check", "label": "Auto-Play AI Responses", "default": "0"},
    {"fieldname": "voice_api_section", "fieldtype": "Section Break", "label": "Voice API (OpenAI TTS/STT)"},
    {"fieldname": "voice_api_key", "fieldtype": "Password", "label": "Voice API Key", "description": "OpenAI API key for TTS/STT. If blank, uses default provider's key."},
    {"fieldname": "voice_base_url", "fieldtype": "Data", "label": "Voice API Base URL", "default": "https://api.openai.com/v1", "description": "Base URL for TTS/STT API (OpenAI-compatible)"},
    {"fieldname": "column_break_voice_api", "fieldtype": "Column Break"},
    {"fieldname": "default_voice", "fieldtype": "Select", "label": "Default TTS Voice", "options": "alloy\necho\nfable\nonyx\nnova\nshimmer", "default": "alloy"},
    {"fieldname": "tts_model", "fieldtype": "Select", "label": "TTS Model", "options": "tts-1\ntts-1-hd", "default": "tts-1"},
    {"fieldname": "image_section", "fieldtype": "Section Break", "label": "Image Generation"},
    {"fieldname": "enable_image_generation", "fieldtype": "Check", "label": "Enable Image Generation", "default": "0"},
    {"fieldname": "image_api_key", "fieldtype": "Password", "label": "Image API Key", "description": "API key for image generation. If blank, uses default provider's key.", "depends_on": "enable_image_generation"},
    {"fieldname": "column_break_image", "fieldtype": "Column Break"},
    {"fieldname": "image_api_url", "fieldtype": "Data", "label": "Image API URL", "default": "https://api.openai.com/v1", "description": "Base URL for image generation API (OpenAI-compatible)", "depends_on": "enable_image_generation"}
  ],
  "issingle": 1,
  "links": [],
  "modified": "2026-02-09 00:00:00",
  "modified_by": "Administrator",
  "module": "Niv Core",
  "name": "Niv Settings",
  "owner": "Administrator",
  "permissions": [
    {"role": "System Manager", "read": 1, "write": 1, "create": 1}
  ],
  "sort_field": "modified",
  "sort_order": "DESC"
}
